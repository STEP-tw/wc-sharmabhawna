wc needs refactoring
duplication is there
small functions can be extracted